---
title: "⚡ [React 성능 2/3] 코드 분할 - lazy & Suspense"
date: "2025-10-06"
description: "React.lazy, Suspense, 번들 최적화 전략을 학습합니다"
tags: ["React", "코드분할", "번들링", "성능", "중급"]
---

# 코드 분할 (Code Splitting) 가이드

> React와 Next.js에서의 코드 분할 학습 자료

---

## 📚 목차

1. [개요](#개요)
2. [React.lazy](#reactlazy)
3. [Suspense](#suspense)
4. [라우트 기반 분할](#라우트-기반-분할)
5. [컴포넌트 기반 분할](#컴포넌트-기반-분할)
6. [Next.js 자동 분할](#nextjs-자동-분할)

---

## 개요

### 코드 분할이란?

**코드 분할**은 번들을 여러 개로 나누어 필요할 때만 로드하는 기법입니다.

**장점:**
- 초기 로딩 시간 단축
- 사용자가 필요한 코드만 다운로드
- 성능 향상

---

## React.lazy

### 기본 사용

```jsx
import { lazy, Suspense } from 'react';

// 동적 import
const HeavyComponent = lazy(() => import('./HeavyComponent'));

function App() {
  return (
    <Suspense fallback={<div>Loading...</div>}>
      <HeavyComponent />
    </Suspense>
  );
}
```

### 조건부 로딩

```jsx
function App() {
  const [showAdmin, setShowAdmin] = useState(false);

  return (
    <div>
      <button onClick={() => setShowAdmin(true)}>
        Show Admin Panel
      </button>

      {showAdmin && (
        <Suspense fallback={<div>Loading Admin...</div>}>
          <AdminPanel />
        </Suspense>
      )}
    </div>
  );
}

const AdminPanel = lazy(() => import('./AdminPanel'));
```

---

## 라우트 기반 분할

```jsx
import { lazy, Suspense } from 'react';
import { BrowserRouter, Routes, Route } from 'react-router-dom';

const Home = lazy(() => import('./pages/Home'));
const About = lazy(() => import('./pages/About'));
const Dashboard = lazy(() => import('./pages/Dashboard'));

function App() {
  return (
    <BrowserRouter>
      <Suspense fallback={<LoadingScreen />}>
        <Routes>
          <Route path="/" element={<Home />} />
          <Route path="/about" element={<About />} />
          <Route path="/dashboard" element={<Dashboard />} />
        </Routes>
      </Suspense>
    </BrowserRouter>
  );
}
```

---

## Next.js 자동 분할

### 자동 코드 분할

```jsx
// Next.js는 각 페이지를 자동으로 분할
// app/about/page.jsx
export default function About() {
  return <div>About</div>;
}

// 자동으로 별도 번들로 분리됨!
```

### Dynamic Import

```jsx
import dynamic from 'next/dynamic';

const DynamicComponent = dynamic(() => import('../components/Heavy'), {
  loading: () => <p>Loading...</p>,
  ssr: false,  // 서버 사이드 렌더링 비활성화
});

export default function Page() {
  return <DynamicComponent />;
}
```

---

## 번들 분석

```bash
npm install --save-dev @next/bundle-analyzer
```

```javascript
// next.config.js
const withBundleAnalyzer = require('@next/bundle-analyzer')({
  enabled: process.env.ANALYZE === 'true',
});

module.exports = withBundleAnalyzer({
  // Next.js config
});
```

```bash
ANALYZE=true npm run build
```

---

**작성일**: 2025-10-11  
**대상**: React 개발자

