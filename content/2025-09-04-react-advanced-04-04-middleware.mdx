---
title: "ğŸš€ [React ë¼ì´ë¸ŒëŸ¬ë¦¬ 4/7] Next.js ê³ ê¸‰ - Middleware"
date: "2025-09-04"
description: "Next.js Middlewareë¡œ ìš”ì²­ ê°€ë¡œì±„ê¸°"
tags: ["Next.js", "React", "ê³ ê¸‰", "í”„ë¡ íŠ¸ì—”ë“œ"]
series: "React ë¼ì´ë¸ŒëŸ¬ë¦¬"
seriesOrder: 62
---

# Next.js ê³ ê¸‰ ê¸°ëŠ¥ ê°€ì´ë“œ - Middleware

> Next.js 15ì˜ ê³ ê¸‰ ê¸°ëŠ¥ì„ ë‹¤ë£¨ëŠ” í•™ìŠµ ìë£Œ

---

## Middleware

### ê¸°ë³¸ Middleware

```jsx
// middleware.js
import { NextResponse } from 'next/server';

export function middleware(request) {
  // ìš”ì²­ ë¡œê¹…
  console.log('Request:', request.nextUrl.pathname);

  // í—¤ë” ì¶”ê°€
  const response = NextResponse.next();
  response.headers.set('x-custom-header', 'my-value');

  return response;
}

export const config = {
  matcher: ['/dashboard/:path*', '/admin/:path*'],
};
```

### ì¸ì¦ Middleware

```jsx
// middleware.js
import { NextResponse } from 'next/server';

export function middleware(request) {
  const token = request.cookies.get('token');

  if (!token && request.nextUrl.pathname.startsWith('/dashboard')) {
    return NextResponse.redirect(new URL('/login', request.url));
  }

  return NextResponse.next();
}

export const config = {
  matcher: '/dashboard/:path*',
};
```

### êµ­ì œí™” Middleware

```jsx
// middleware.js
import { NextResponse } from 'next/server';

const locales = ['en', 'ko', 'ja'];
const defaultLocale = 'en';

export function middleware(request) {
  const pathname = request.nextUrl.pathname;

  // ì´ë¯¸ ë¡œì¼€ì¼ì´ ìˆìœ¼ë©´ íŒ¨ìŠ¤
  const pathnameHasLocale = locales.some(
    (locale) => pathname.startsWith(`/${locale}/`) || pathname === `/${locale}`
  );

  if (pathnameHasLocale) return;

  // Accept-Language í—¤ë”ì—ì„œ ë¡œì¼€ì¼ ê°€ì ¸ì˜¤ê¸°
  const locale = request.headers.get('accept-language')?.split(',')[0] || defaultLocale;

  // ë¡œì¼€ì¼ ì¶”ê°€í•˜ì—¬ ë¦¬ë‹¤ì´ë ‰íŠ¸
  return NextResponse.redirect(
    new URL(`/${locale}${pathname}`, request.url)
  );
}

export const config = {
  matcher: ['/((?!api|_next/static|_next/image|favicon.ico).*)'],
};
```

### A/B í…ŒìŠ¤íŠ¸ Middleware

```jsx
// middleware.js
import { NextResponse } from 'next/server';

export function middleware(request) {
  // ì¿ í‚¤ì—ì„œ ë²„í‚· í™•ì¸
  let bucket = request.cookies.get('bucket');

  if (!bucket) {
    // ëœë¤í•˜ê²Œ A ë˜ëŠ” B í• ë‹¹
    bucket = Math.random() < 0.5 ? 'a' : 'b';
    const response = NextResponse.next();
    response.cookies.set('bucket', bucket);
    return response;
  }

  // ë²„í‚·ì— ë”°ë¼ ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ë¦¬ë¼ì´íŠ¸
  if (bucket === 'b') {
    return NextResponse.rewrite(new URL('/experiment-b', request.url));
  }

  return NextResponse.next();
}
```

---